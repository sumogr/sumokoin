name: Continuous_Integration_Testing

on: [push, pull_request]

jobs:

  cross-build-linux-32bit-binaries-on-xenial:
    runs-on: ubuntu-20.04
    steps:
    - uses: actions/checkout@v1
    - name: clean ubuntu
      run: |
        sudo apt-get update
        sudo apt-get install aptitude
        sudo apt-get purge binutils
        sudo apt-get purge $(aptitude search '~i!~M!~prequired!~pimportant!~R~prequired!~R~R~prequired!~R~pimportant!~R~R~pimportant!busybox!grub!initramfs-tools' | awk '{print $2}')
        sudo apt-get purge aptitude
        sudo apt-get autoremove
        sudo apt-get clean
        sudo apt-get upgrade
    - name: install sumokoin dependencies
      run: |
        sudo apt-get update
        sudo apt-get install g++-multilib bc automake gperf libtool cmake curl git m4 pkg-config libc-bin libc6 libgcc-s1 libglib2.0-0 libgssapi-krb5-2 libgssapi3-heimdal libhcrypto4-heimdal libk5crypto3 libklibc libkrb5-3 libstdc++6  
        sudo apt-get install build-essential cmake libboost-all-dev miniupnpc libunbound-dev libevent-dev graphviz doxygen libunwind8-dev pkg-config libssl-dev libzmq3-dev libsodium-dev libhidapi-dev libnorm-dev libusb-1.0-0-dev libpgm-dev ccache
    - name: cross compile sumokoin for linux 32bit 
      run: make depends target=i686-linux-gnu -j 3    
